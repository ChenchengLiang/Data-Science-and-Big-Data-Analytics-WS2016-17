library("forecast")
x=scan("http://robjhyndman.com/tsdldata/data/nybirths.dat")
plot(x)
lines(x)
myts <- ts(x, start=c(1946, 1), frequency=12)
plot(myts)
fit <- stl(myts, s.window="period")
plot(fit)
fit <- stl(myts, s.window="period",t.window=101)
plot(fit)
fit <- stl(myts, s.window="period")
plot(fit)
###################################################
fit <- stl(myts, s.window="period",t.window=101)
plot(fit)
monthplot(myts)
seasonplot(myts)
fit = arima(myts, order=c(1, 1, 1))
fit_auto = auto.arima(myts)
forecast(fit, 12)
plot(forecast(fit, 12))
forecast(fit_auto, 12)
plot(forecast(fit_auto, 12))
fit <- stl(myts, s.window="period")
fit <- stl(myts, s.window="period",t.window=101)
fit <- stl(myts, s.window="period")
fit$time.series
myts
plot(fit$time.series)
plot(fit)
plot(myts)
plot(fit)
fit <- stl(myts, s.window="period",t.window=101)
plot(fit)
fit <- stl(myts, s.window="period")
plot(fit)
fit <- stl(myts)
plot(fit)
fit <- stl(myts,s.degree=0)
fit <- stl(myts,s.window="period",s.degree=0)
plot(fit)
fit <- stl(myts,s.window="period",s.degree=1)
plot(fit)
fit <- stl(myts,s.window="period",s.degree=0)
plot(fit)
fit <- stl(myts,s.window="period",s.degree=1)
plot(fit)
plot(myts)
fit <- stl(myts, s.window="period")
plot(fit)
fit <- stl(myts, s.window="period")
decomposed_myts=decompose(myts,"additive")
plot(decomposed_myts)
plot(decomposed_myts)
plot(seasonal_adjusted_myts)
seasonal_adjusted_myts=myts-decomposed_myts$seasonal
plot(seasonal_adjusted_myts)
par(mfrowï¼c(1,2))
plot(seasonal_adjusted_myts)
plot(myts)
par(mfrow = c(2, 1))  # 3 rows and 1 columns
plot(seasonal_adjusted_myts)
plot(myts)
par(mfrow = c(2, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
#plot(forecast(fit, 12))
plot(forecast(model_arima_auto, 12))
forecast(model_arima, 12)
library("forecast")
par(mfrow = c(2, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
#plot(forecast(fit, 12))
plot(forecast(model_arima_auto, 12))
# fit an ARIMA model of order P, D, Q
model_arima = arima(seasonal_adjusted_myts, order=c(1, 1, 1))
model_arima_auto = auto.arima(seasonal_adjusted_myts)
# predictive accuracy
par(mfrow = c(2, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
#plot(forecast(fit, 12))
plot(forecast(model_arima_auto, 12))
model_arima_auto_unjusted_ts = auto.arima(myts)
par(mfrow = c(3, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
#plot(forecast(fit, 12))
plot(forecast(model_arima_auto, 12))
#plot(forecast(fit_auto, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(stl_myts)
stl_myts=stl(myts, s.window="periodic")
plot(stl_myts)
plot(decomposed_myts)
stl_myts=stl(myts, s.window="periodic")
seasonal_stl_myts=stl_myts$time.series[,1]
adjusted_stl=stl_myts-seasonal_stl_myts
model_arima_auto_justed_stl = auto.arima(adjusted_stl)
stl_myts=stl(myts, s.window="periodic")
seasonal_stl_myts = stl_myts$time.series[,1]
adjusted_stl = stl_myts - seasonal_stl_myts
adjusted_stl = myts - seasonal_stl_myts
model_arima_auto_justed_stl = auto.arima(adjusted_stl)
par(mfrow = c(4, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(forecast(model_arima_auto, 12))
plot(model_arima_auto_justed_stl)
par(mfrow = c(4, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(forecast(model_arima_auto, 12))
plot(forecast(model_arima_auto_justed_stl, 12))
par(mfrow = c(4, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(forecast(model_arima_auto, 12))
plot(forecast(model_arima_auto_justed_stl, 12))
library("forecast")
stl_myts=stl(myts, s.window="periodic")
seasonal_stl_myts = stl_myts$time.series[,1]
adjusted_stl = myts - seasonal_stl_myts
model_arima_auto_justed_stl = auto.arima(adjusted_stl)
plot(forecast(model_arima_auto_justed_stl, 12))
x=scan("http://robjhyndman.com/tsdldata/data/nybirths.dat")
myts <- ts(x, start=c(1946, 1), frequency=12)
decomposed_myts=decompose(myts,"additive")
seasonal_adjusted_myts=myts-decomposed_myts$seasonal
# fit an ARIMA model of order P, D, Q
model_arima = arima(seasonal_adjusted_myts, order=c(1, 1, 1))
model_arima_auto_unjusted_ts = auto.arima(myts)
model_arima_auto = auto.arima(seasonal_adjusted_myts)
par(mfrow = c(4, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(forecast(model_arima_auto, 12))
plot(forecast(model_arima_auto_justed_stl, 12))
par(mfrow = c(4, 1))  # 3 rows and 1 columns
#plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(forecast(model_arima_auto, 12))
plot(forecast(model_arima_auto_justed_stl, 12))
par(mfrow = c(3, 1))  # 3 rows and 1 columns
#plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(forecast(model_arima_auto, 12))
plot(forecast(model_arima_auto_justed_stl, 12))
par(mfrow = c(3, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(forecast(model_arima_auto, 12))
model_arima_auto1 = auto.arima(seasonal_adjusted_myts)
plot(forecast(model_arima_auto, 12))
plot(forecast(model_arima_auto1, 12))
par(mfrow = c(3, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(forecast(model_arima_auto, 12))
model_arima = arima(seasonal_adjusted_myts, order=c(3, 1, 1))
par(mfrow = c(3, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
plot(forecast(model_arima_auto, 12))
plot(forecast(model_arima_auto, 12))
par(mfrow = c(3, 1))  # 3 rows and 1 columns
plot(forecast(model_arima, 12))
plot(forecast(model_arima_auto, 12))
plot(forecast(model_arima_auto_unjusted_ts, 12))
decomposed_myts
